
---------------------------------------------------------------
Test Vectors for EDHOC Authenticated with Signature (RPK) + Signature (RPK)
---------------------------------------------------------------

Initiator COSE_Key =
{
   2:  h'2a',
   1:  1,
  -1:  6,
  -2:  h'280c7dcaed07be0690238a9aeb068d7e307f19b9f0fc86a3cdc30f7b641988ad',
  -4:  h'3da13d1f57cf58ddeebae88c92679c2c88dc792423e971b3c17f5ab83b79ad89',
}

Responder COSE_Key =
{
   2:  h'2b',
   1:  1,
  -1:  6,
  -2:  h'84232d9d24ba67d2d950d25162967be0f485ecfb14928a875554a13715d9569f',
  -4:  h'274afdff35e7bf98d28a8bbb98a504d861d7025be4e4e7bcb5061733a3d38a46',
}

method (Signature + Singature)
0

---------------------------------------------------------------

corr (Initiator can correlate message_1 and message_2)
1

METHOD_CORR (4 * method + corr)
1

suite
0

X (Initiator's ephemeral private key) (32 bytes)
fc 14 ac 67 67 80 c4 0e 5c fe b5 b8 70 1b 14 76 1a 89 b5 51 9e af 66 3b 29 e7 f8 ab bd c7 21 95 

G_X (Initiator's ephemeral public key) (32 bytes)
85 78 8f 6e 8c 18 18 fd 43 14 b8 41 a8 7f fb 91 af 60 d9 5a a9 83 38 49 6c d1 7b a1 cb f1 53 2b 

Connection identifier chosen by Initiator (1 bytes)
0a 

message_1 (CBOR Sequence) (37 bytes)
01 00 58 20 85 78 8f 6e 8c 18 18 fd 43 14 b8 41 a8 7f fb 91 af 60 d9 5a a9 83 38 49 6c d1 7b a1 cb f1 53 2b 2d 

---------------------------------------------------------------

Y (Responder's ephemeral private key) (32 bytes)
93 97 5d aa cc 73 60 e4 9e 74 d3 e2 3b 95 cc 2b b5 a0 9a 95 87 d3 3b 86 68 be 8f 39 ea bc f3 f2 

G_Y (Responder's ephemeral public key) (32 bytes)
5f d6 1d df 41 b1 0f 75 d3 9b 50 e9 a3 02 28 c7 fe e2 2c c8 af db 17 80 e4 86 12 ba bf 8e be 11 

G_XY (ECDH shared secret) (32 bytes)
fd c4 55 e1 a1 b3 c3 88 cf e4 5b 20 a9 7a e8 b0 61 ad b4 5d 83 2b 01 f5 90 c0 70 06 7c 7a ea 08 

salt (0 bytes)


PRK_2e (32 bytes)
86 62 da cc e6 1d 59 8a e2 83 9d 49 b6 54 48 75 f4 ab 4c 18 46 8f 3a b8 fd 9f 87 04 b0 63 42 14 

PRK_3e2m (32 bytes)
86 62 da cc e6 1d 59 8a e2 83 9d 49 b6 54 48 75 f4 ab 4c 18 46 8f 3a b8 fd 9f 87 04 b0 63 42 14 

Connection identifier chosen by Responder (1 bytes)
0b 

data_2 (CBOR Sequence) (35 bytes)
58 20 5f d6 1d df 41 b1 0f 75 d3 9b 50 e9 a3 02 28 c7 fe e2 2c c8 af db 17 80 e4 86 12 ba bf 8e be 11 2c 

Input to SHA-256 to calculate TH_2 ( message_1, data_2 ) (CBOR Sequence) (72 bytes)
01 00 58 20 85 78 8f 6e 8c 18 18 fd 43 14 b8 41 a8 7f fb 91 af 60 d9 5a a9 83 38 49 6c d1 7b a1 cb f1 53 2b 2d 58 20 5f d6 1d df 41 b1 0f 75 d3 9b 50 e9 a3 02 28 c7 fe e2 2c c8 af db 17 80 e4 86 12 ba bf 8e be 11 2c 

TH_2 (32 bytes)
a6 c0 f0 bf 1e 73 d8 65 f9 fc 5e c0 1b 0a e2 04 4c 14 80 53 f2 df 5f 20 72 98 21 ff 1f c9 7c c6 

ID_CRED_R (4 bytes)
a1 04 41 2b 

CRED_R (40 bytes)
a3 01 01 20 06 21 58 20 84 23 2d 9d 24 ba 67 d2 d9 50 d2 51 62 96 7b e0 f4 85 ec fb 14 92 8a 87 55 54 a1 37 15 d9 56 9f 

P_2m (0 bytes)


A_2m (CBOR-encoded) (91 bytes)
83 68 45 6e 63 72 79 70 74 30 44 a1 04 41 2b 58 4a a3 01 01 20 06 21 58 20 84 23 2d 9d 24 ba 67 d2 d9 50 d2 51 62 96 7b e0 f4 85 ec fb 14 92 8a 87 55 54 a1 37 15 d9 56 9f 58 20 a6 c0 f0 bf 1e 73 d8 65 f9 fc 5e c0 1b 0a e2 04 4c 14 80 53 f2 df 5f 20 72 98 21 ff 1f c9 7c c6 

info for K_2m (CBOR-encoded) (53 bytes)
84 0a 83 f6 f6 f6 83 f6 f6 f6 83 18 80 45 44 a1 04 41 2b 58 20 a6 c0 f0 bf 1e 73 d8 65 f9 fc 5e c0 1b 0a e2 04 4c 14 80 53 f2 df 5f 20 72 98 21 ff 1f c9 7c c6 

K_2m (16 bytes)
3e e6 c3 18 ee 1c 37 11 69 c3 98 ee f1 94 5b d4 

info for IV_2m (CBOR-encoded) (66 bytes)
84 6d 49 56 2d 47 45 4e 45 52 41 54 49 4f 4e 83 f6 f6 f6 83 f6 f6 f6 83 18 68 45 44 a1 04 41 2b 58 20 a6 c0 f0 bf 1e 73 d8 65 f9 fc 5e c0 1b 0a e2 04 4c 14 80 53 f2 df 5f 20 72 98 21 ff 1f c9 7c c6 

IV_2m (13 bytes)
62 7a 5e 1a 7a 43 d3 59 32 1f 03 60 ab 

MAC_2 (8 bytes)
38 43 36 77 09 06 6c 89 

M_2 (message to be signed by Responder) (CBOR-encoded) (192 bytes)
84 6a 53 69 67 6e 61 74 75 72 65 31 44 a1 04 41 2b 58 4a a3 01 01 20 06 21 58 20 84 23 2d 9d 24 ba 67 d2 d9 50 d2 51 62 96 7b e0 f4 85 ec fb 14 92 8a 87 55 54 a1 37 15 d9 56 9f 58 20 a6 c0 f0 bf 1e 73 d8 65 f9 fc 5e c0 1b 0a e2 04 4c 14 80 53 f2 df 5f 20 72 98 21 ff 1f c9 7c c6 48 38 43 36 77 09 06 6c 89 44 a1 04 41 2a 58 4a a3 01 01 20 06 21 58 20 28 0c 7d ca ed 07 be 06 90 23 8a 9a eb 06 8d 7e 30 7f 19 b9 f0 fc 86 a3 cd c3 0f 7b 64 19 88 ad 58 20 ee 3d 14 a2 61 c7 24 b8 a6 b8 61 ee aa 3a e2 f2 bb a1 7a c8 ae 40 0f 28 b4 92 11 b7 81 ee 4c 51 48 dd 05 6f 38 1d b3 ae c4 

Signature_or_MAC_2 (64 bytes)
6e e2 93 7a ff d5 a8 d9 e4 d9 9f f2 b7 23 c6 6d 1d 27 1d 85 3d c5 58 2e ce b9 ef 13 b2 22 67 17 be cb aa 7b 22 cf ea 73 1b 89 1a f5 db 35 b5 60 19 5d f7 6f 25 cb f4 42 62 26 df 6f cf 11 a1 09 

P_2e (67 bytes)
13 58 40 6e e2 93 7a ff d5 a8 d9 e4 d9 9f f2 b7 23 c6 6d 1d 27 1d 85 3d c5 58 2e ce b9 ef 13 b2 22 67 17 be cb aa 7b 22 cf ea 73 1b 89 1a f5 db 35 b5 60 19 5d f7 6f 25 cb f4 42 62 26 df 6f cf 11 a1 09 

info for K_2e (CBOR-encoded) (62 bytes)
84 6e 58 4f 52 2d 45 4e 43 52 59 50 54 49 4f 4e 83 f6 f6 f6 83 f6 f6 f6 83 18 18 40 58 20 a6 c0 f0 bf 1e 73 d8 65 f9 fc 5e c0 1b 0a e2 04 4c 14 80 53 f2 df 5f 20 72 98 21 ff 1f c9 7c c6 

K_2e (67 bytes)
47 42 b4 f8 a2 b2 93 12 18 42 6a 0d d3 ac 3f fd f5 34 ca a9 fe 86 42 a1 2f be d5 0c 2d 63 ec 6d 07 b2 2c 15 00 51 18 75 9c ba 56 ec f4 ba 90 61 d4 dd 5f 58 06 f5 a2 de 4d 3d 9e df 46 2b e0 c5 6c d1 5f 

CIPHERTEXT_2 (67 bytes)
54 1a f4 96 40 21 e9 ed cd ea b3 e9 0a 33 cd 4a d6 f2 a7 b4 d9 9b c7 9c ea e6 fb c2 94 8c ff df 25 d5 3b ab cb fb 63 57 53 50 25 f7 7d a0 65 ba e1 68 3f 41 5b 02 cd fb 86 c9 dc bd 60 f4 8f 0a 7d 70 56 

message_2 (CBOR Sequence) (104 bytes)
58 20 5f d6 1d df 41 b1 0f 75 d3 9b 50 e9 a3 02 28 c7 fe e2 2c c8 af db 17 80 e4 86 12 ba bf 8e be 11 2c 58 43 54 1a f4 96 40 21 e9 ed cd ea b3 e9 0a 33 cd 4a d6 f2 a7 b4 d9 9b c7 9c ea e6 fb c2 94 8c ff df 25 d5 3b ab cb fb 63 57 53 50 25 f7 7d a0 65 ba e1 68 3f 41 5b 02 cd fb 86 c9 dc bd 60 f4 8f 0a 7d 70 56 

---------------------------------------------------------------

PRK_4x3m (32 bytes)
86 62 da cc e6 1d 59 8a e2 83 9d 49 b6 54 48 75 f4 ab 4c 18 46 8f 3a b8 fd 9f 87 04 b0 63 42 14 

data_3 (CBOR Sequence) (1 bytes)
2c 

Input to SHA-256 to calculate TH_3 ( TH_2, CIPHERTEXT_2, data_3 ) (CBOR Sequence) (104 bytes)
58 20 a6 c0 f0 bf 1e 73 d8 65 f9 fc 5e c0 1b 0a e2 04 4c 14 80 53 f2 df 5f 20 72 98 21 ff 1f c9 7c c6 58 43 54 1a f4 96 40 21 e9 ed cd ea b3 e9 0a 33 cd 4a d6 f2 a7 b4 d9 9b c7 9c ea e6 fb c2 94 8c ff df 25 d5 3b ab cb fb 63 57 53 50 25 f7 7d a0 65 ba e1 68 3f 41 5b 02 cd fb 86 c9 dc bd 60 f4 8f 0a 7d 70 56 2c 

TH_3 (32 bytes)
ee 3d 14 a2 61 c7 24 b8 a6 b8 61 ee aa 3a e2 f2 bb a1 7a c8 ae 40 0f 28 b4 92 11 b7 81 ee 4c 51 

ID_CRED_I (4 bytes)
a1 04 41 2a 

CRED_I (40 bytes)
a3 01 01 20 06 21 58 20 28 0c 7d ca ed 07 be 06 90 23 8a 9a eb 06 8d 7e 30 7f 19 b9 f0 fc 86 a3 cd c3 0f 7b 64 19 88 ad 

P_3m (0 bytes)


A_3m (CBOR-encoded) (91 bytes)
83 68 45 6e 63 72 79 70 74 30 44 a1 04 41 2a 58 4a a3 01 01 20 06 21 58 20 28 0c 7d ca ed 07 be 06 90 23 8a 9a eb 06 8d 7e 30 7f 19 b9 f0 fc 86 a3 cd c3 0f 7b 64 19 88 ad 58 20 ee 3d 14 a2 61 c7 24 b8 a6 b8 61 ee aa 3a e2 f2 bb a1 7a c8 ae 40 0f 28 b4 92 11 b7 81 ee 4c 51 

info for K_3m (CBOR-encoded) (53 bytes)
84 0a 83 f6 f6 f6 83 f6 f6 f6 83 18 80 45 44 a1 04 41 2a 58 20 ee 3d 14 a2 61 c7 24 b8 a6 b8 61 ee aa 3a e2 f2 bb a1 7a c8 ae 40 0f 28 b4 92 11 b7 81 ee 4c 51 

K_3m (16 bytes)
8e 78 ae 0d 8a 42 1a d0 0f bb 10 24 b8 ea 53 07 

info for IV_3m (CBOR-encoded) (66 bytes)
84 6d 49 56 2d 47 45 4e 45 52 41 54 49 4f 4e 83 f6 f6 f6 83 f6 f6 f6 83 18 68 45 44 a1 04 41 2a 58 20 ee 3d 14 a2 61 c7 24 b8 a6 b8 61 ee aa 3a e2 f2 bb a1 7a c8 ae 40 0f 28 b4 92 11 b7 81 ee 4c 51 

IV_3m (13 bytes)
61 f2 70 c7 47 f5 04 a5 fd 8d 25 10 c9 

MAC_3 (8 bytes)
dd 05 6f 38 1d b3 ae c4 

M_3 (message to be signed by Initiator) (CBOR-encoded) (12 bytes)
84 6a 53 69 67 6e 61 74 75 72 65 31 

Signature_or_MAC_2 (64 bytes)
6e e2 93 7a ff d5 a8 d9 e4 d9 9f f2 b7 23 c6 6d 1d 27 1d 85 3d c5 58 2e ce b9 ef 13 b2 22 67 17 be cb aa 7b 22 cf ea 73 1b 89 1a f5 db 35 b5 60 19 5d f7 6f 25 cb f4 42 62 26 df 6f cf 11 a1 09 

P_3ae (67 bytes)
12 58 40 37 10 39 26 56 56 56 86 d7 36 fc d8 69 b1 91 46 e2 d8 b8 78 45 aa 42 cd 85 43 13 5a e9 f1 46 50 a7 43 58 69 ac ce de 7b 9a 54 45 9a 76 c2 39 6e 4c 51 6d de 37 cc dd 3b e5 3c 73 22 7b 58 5e 06 

A_3ae (CBOR-encoded) (45 bytes)
83 68 45 6e 63 72 79 70 74 30 40 58 20 ee 3d 14 a2 61 c7 24 b8 a6 b8 61 ee aa 3a e2 f2 bb a1 7a c8 ae 40 0f 28 b4 92 11 b7 81 ee 4c 51 

info for K_3ae (CBOR-encoded) (48 bytes)
84 0a 83 f6 f6 f6 83 f6 f6 f6 83 18 80 40 58 20 ee 3d 14 a2 61 c7 24 b8 a6 b8 61 ee aa 3a e2 f2 bb a1 7a c8 ae 40 0f 28 b4 92 11 b7 81 ee 4c 51 

K_3ae (16 bytes)
f5 bb cf 01 58 f4 7c d7 b1 b1 4e 40 09 87 64 5e 

info for IV_3ae (CBOR-encoded) (61 bytes)
84 6d 49 56 2d 47 45 4e 45 52 41 54 49 4f 4e 83 f6 f6 f6 83 f6 f6 f6 83 18 68 40 58 20 ee 3d 14 a2 61 c7 24 b8 a6 b8 61 ee aa 3a e2 f2 bb a1 7a c8 ae 40 0f 28 b4 92 11 b7 81 ee 4c 51 

IV_3ae (13 bytes)
37 61 95 55 b0 85 38 4e fa 21 74 38 ca 

CIPHERTEXT_3 (75 bytes)
d6 05 25 d8 39 d6 1b bb 04 a0 73 0a f9 51 f6 25 b6 85 c0 93 43 40 21 29 e2 0f 25 4c c2 15 ef 91 1a 68 21 42 64 16 ee a8 bc 6f 85 3b 1c d6 0d f0 5e 15 80 85 dc 33 bf b0 92 55 36 65 04 74 5f 0a 97 8d 09 82 d6 0c 9a bc 41 f0 fc 

message_3 (CBOR Sequence) (78 bytes)
2c 58 4b d6 05 25 d8 39 d6 1b bb 04 a0 73 0a f9 51 f6 25 b6 85 c0 93 43 40 21 29 e2 0f 25 4c c2 15 ef 91 1a 68 21 42 64 16 ee a8 bc 6f 85 3b 1c d6 0d f0 5e 15 80 85 dc 33 bf b0 92 55 36 65 04 74 5f 0a 97 8d 09 82 d6 0c 9a bc 41 f0 fc 

---------------------------------------------------------------

Input to SHA-256 to calculate TH_4 ( TH_3, CIPHERTEXT_3 ) (CBOR Sequence) (111 bytes)
58 20 ee 3d 14 a2 61 c7 24 b8 a6 b8 61 ee aa 3a e2 f2 bb a1 7a c8 ae 40 0f 28 b4 92 11 b7 81 ee 4c 51 58 4b d6 05 25 d8 39 d6 1b bb 04 a0 73 0a f9 51 f6 25 b6 85 c0 93 43 40 21 29 e2 0f 25 4c c2 15 ef 91 1a 68 21 42 64 16 ee a8 bc 6f 85 3b 1c d6 0d f0 5e 15 80 85 dc 33 bf b0 92 55 36 65 04 74 5f 0a 97 8d 09 82 d6 0c 9a bc 41 f0 fc 

TH_4 (32 bytes)
b8 17 79 d7 45 88 d1 e7 cf da 67 2c b6 17 53 d9 0a df c9 c5 18 dc e6 94 1d c7 34 31 77 b6 3e b1 

info for OSCORE Master Secret (CBOR-encoded) (68 bytes)
84 74 4f 53 43 4f 52 45 20 4d 61 73 74 65 72 20 53 65 63 72 65 74 83 f6 f6 f6 83 f6 f6 f6 83 18 80 40 58 20 b8 17 79 d7 45 88 d1 e7 cf da 67 2c b6 17 53 d9 0a df c9 c5 18 dc e6 94 1d c7 34 31 77 b6 3e b1 

OSCORE Master Secret (16 bytes)
76 7a 0d 09 47 bb 5b ef 4d 1c 03 a1 ca 08 87 53 

info for OSCORE Master Salt (CBOR-encoded) (66 bytes)
84 72 4f 53 43 4f 52 45 20 4d 61 73 74 65 72 20 53 61 6c 74 83 f6 f6 f6 83 f6 f6 f6 83 18 40 40 58 20 b8 17 79 d7 45 88 d1 e7 cf da 67 2c b6 17 53 d9 0a df c9 c5 18 dc e6 94 1d c7 34 31 77 b6 3e b1 

OSCORE Master Salt (8 bytes)
4d aa 9f 16 f7 aa 1b 69 

Client's OSCORE Sender ID (1 bytes)
0b 

Server's OSCORE Sender ID (1 bytes)
0a 

AEAD Algorithm
10

HMAC Algorithm
5

---------------------------------------------------------------
Test Vectors for EDHOC Authenticated with Static DH (RPK) + Static DH (RPK)
---------------------------------------------------------------

Initiator COSE_Key =
{
   2:  h'21',
   1:  1,
  -1:  4,
  -2:  h'573243f0c7982b0597080a55eaf50f8465d31b9740e43e5b248bb12ef4ebd64c',
  -4:  h'25de413f778efc4b357bd317f087e283ac4528078c6b1e774389a819bdfd789a',
}

Responder COSE_Key =
{
   2:  h'22',
   1:  1,
  -1:  4,
  -2:  h'89a9ab72432cc4267014045c914d6cdad8bd717e162cbff80c9ba40e30743b61',
  -4:  h'e468d42efa90972f80fc356deecf6d60e060e9237ccf846c7c25549e3b195044',
}

method (Static DH + Static DH)
3

---------------------------------------------------------------

corr (Initiator can correlate message_1 and message_2)
1

METHOD_CORR (4 * method + corr)
13

suite
0

X (Initiator's ephemeral private key) (32 bytes)
b3 21 ee dd 30 af bd 65 cc 15 35 cd 17 3a 20 84 f0 0d 48 c5 db 6d 84 82 0c 19 3f 95 93 13 12 43 

G_X (Initiator's ephemeral public key) (32 bytes)
02 f9 e3 f7 9d 4a 72 9b 44 08 ed 14 ab a4 61 f2 8c 71 51 93 e3 a9 98 a8 42 fb 99 e6 4a ed f2 50 

Connection identifier chosen by Initiator (1 bytes)
01 

message_1 (CBOR Sequence) (37 bytes)
0d 00 58 20 02 f9 e3 f7 9d 4a 72 9b 44 08 ed 14 ab a4 61 f2 8c 71 51 93 e3 a9 98 a8 42 fb 99 e6 4a ed f2 50 36 

---------------------------------------------------------------

Y (Responder's ephemeral private key) (32 bytes)
e2 a9 4e 18 64 7f e0 c6 28 3a 31 e4 0c 46 ae 1c c5 f0 86 76 50 f6 83 4e 4f 01 e3 42 84 ad c9 c7 

G_Y (Responder's ephemeral public key) (32 bytes)
89 e2 e1 7b 0a 38 4f ec b8 05 70 84 b5 b1 ba 5b 5c 3c 0e ca 44 03 88 43 21 03 a9 c6 e1 52 d8 1f 

G_XY (ECDH shared secret) (32 bytes)
e9 5f 7c 32 c8 61 5d 70 47 42 20 e1 c9 b6 ed b6 82 92 e4 c6 79 bf eb e5 c0 c2 a6 c2 fc 95 42 06 

salt (0 bytes)


PRK_2e (32 bytes)
cf c3 10 87 6a 34 8a 69 4f 2d 71 8e e8 67 e6 6d 14 b2 a2 87 0a d3 f3 93 ac 77 6b 8b e8 01 77 9b 

G_RX (ECDH shared secret) (32 bytes)
b9 9c b1 f5 e9 e3 ed d2 26 61 64 79 6b a8 d6 be 22 bb ed 8a 24 8b a2 48 bd 16 b7 d3 c1 df f7 3e 

PRK_3e2m (32 bytes)
2a 33 45 4d 6c 2d d8 15 bc b3 91 ab 3a 94 a8 5e 4f ec cf b4 52 cc c4 99 61 f8 a5 98 7e 22 89 45 

Connection identifier chosen by Responder (1 bytes)
02 

data_2 (CBOR Sequence) (35 bytes)
58 20 89 e2 e1 7b 0a 38 4f ec b8 05 70 84 b5 b1 ba 5b 5c 3c 0e ca 44 03 88 43 21 03 a9 c6 e1 52 d8 1f 35 

Input to SHA-256 to calculate TH_2 ( message_1, data_2 ) (CBOR Sequence) (72 bytes)
0d 00 58 20 02 f9 e3 f7 9d 4a 72 9b 44 08 ed 14 ab a4 61 f2 8c 71 51 93 e3 a9 98 a8 42 fb 99 e6 4a ed f2 50 36 58 20 89 e2 e1 7b 0a 38 4f ec b8 05 70 84 b5 b1 ba 5b 5c 3c 0e ca 44 03 88 43 21 03 a9 c6 e1 52 d8 1f 35 

TH_2 (32 bytes)
1f 16 a1 f3 3d 4f ff 7c e4 a1 86 d8 73 c9 a5 a4 76 76 eb 62 df 51 6f e0 df 0f 8a ae 18 5b 88 c7 

ID_CRED_R (4 bytes)
a1 04 41 22 

CRED_R (40 bytes)
a3 01 01 20 04 21 58 20 89 a9 ab 72 43 2c c4 26 70 14 04 5c 91 4d 6c da d8 bd 71 7e 16 2c bf f8 0c 9b a4 0e 30 74 3b 61 

P_2m (0 bytes)


A_2m (CBOR-encoded) (91 bytes)
83 68 45 6e 63 72 79 70 74 30 44 a1 04 41 22 58 4a a3 01 01 20 04 21 58 20 89 a9 ab 72 43 2c c4 26 70 14 04 5c 91 4d 6c da d8 bd 71 7e 16 2c bf f8 0c 9b a4 0e 30 74 3b 61 58 20 1f 16 a1 f3 3d 4f ff 7c e4 a1 86 d8 73 c9 a5 a4 76 76 eb 62 df 51 6f e0 df 0f 8a ae 18 5b 88 c7 

info for K_2m (CBOR-encoded) (53 bytes)
84 0a 83 f6 f6 f6 83 f6 f6 f6 83 18 80 45 44 a1 04 41 22 58 20 1f 16 a1 f3 3d 4f ff 7c e4 a1 86 d8 73 c9 a5 a4 76 76 eb 62 df 51 6f e0 df 0f 8a ae 18 5b 88 c7 

K_2m (16 bytes)
94 84 78 21 b5 ba 95 56 5d 32 fd 9b 95 7e c6 2f 

info for IV_2m (CBOR-encoded) (66 bytes)
84 6d 49 56 2d 47 45 4e 45 52 41 54 49 4f 4e 83 f6 f6 f6 83 f6 f6 f6 83 18 68 45 44 a1 04 41 22 58 20 1f 16 a1 f3 3d 4f ff 7c e4 a1 86 d8 73 c9 a5 a4 76 76 eb 62 df 51 6f e0 df 0f 8a ae 18 5b 88 c7 

IV_2m (13 bytes)
5d c2 25 14 cb a7 39 63 7a 93 1c 23 06 

MAC_2 (8 bytes)
d5 2b 3f c1 87 5d c2 78 

Signature_or_MAC_2 (8 bytes)
d5 2b 3f c1 87 5d c2 78 

P_2e (10 bytes)
0a 48 d5 2b 3f c1 87 5d c2 78 

info for K_2e (CBOR-encoded) (62 bytes)
84 6e 58 4f 52 2d 45 4e 43 52 59 50 54 49 4f 4e 83 f6 f6 f6 83 f6 f6 f6 83 18 50 40 58 20 1f 16 a1 f3 3d 4f ff 7c e4 a1 86 d8 73 c9 a5 a4 76 76 eb 62 df 51 6f e0 df 0f 8a ae 18 5b 88 c7 

K_2e (10 bytes)
98 a6 f0 51 74 94 f5 38 f3 49 

CIPHERTEXT_2 (10 bytes)
92 ee 25 7a 4b 55 72 65 31 31 

message_2 (CBOR Sequence) (46 bytes)
58 20 89 e2 e1 7b 0a 38 4f ec b8 05 70 84 b5 b1 ba 5b 5c 3c 0e ca 44 03 88 43 21 03 a9 c6 e1 52 d8 1f 35 4a 92 ee 25 7a 4b 55 72 65 31 31 

---------------------------------------------------------------

G_IY (ECDH shared secret) (32 bytes)
f0 e2 0e 3f db 17 5c 4d 91 66 c6 aa e8 a0 45 eb d9 6d 55 65 66 b1 ff e3 40 ed d9 10 74 05 7b 58 

PRK_4x3m (32 bytes)
6e 37 c3 21 13 99 a6 53 c0 01 08 c3 81 33 4e fd ca b6 9d 09 6d 22 0a 63 93 15 68 a5 31 54 90 e1 

data_3 (CBOR Sequence) (1 bytes)
35 

Input to SHA-256 to calculate TH_3 ( TH_2, CIPHERTEXT_2, data_3 ) (CBOR Sequence) (46 bytes)
58 20 1f 16 a1 f3 3d 4f ff 7c e4 a1 86 d8 73 c9 a5 a4 76 76 eb 62 df 51 6f e0 df 0f 8a ae 18 5b 88 c7 4a 92 ee 25 7a 4b 55 72 65 31 31 35 

TH_3 (32 bytes)
c4 89 10 bc 50 8a f7 46 0f 66 6d fa f3 41 e5 e1 e0 11 03 25 cf ae d2 c8 93 c8 8c 3e 41 e8 33 e6 

ID_CRED_I (4 bytes)
a1 04 41 21 

CRED_I (40 bytes)
a3 01 01 20 04 21 58 20 57 32 43 f0 c7 98 2b 05 97 08 0a 55 ea f5 0f 84 65 d3 1b 97 40 e4 3e 5b 24 8b b1 2e f4 eb d6 4c 

P_3m (0 bytes)


A_3m (CBOR-encoded) (91 bytes)
83 68 45 6e 63 72 79 70 74 30 44 a1 04 41 21 58 4a a3 01 01 20 04 21 58 20 57 32 43 f0 c7 98 2b 05 97 08 0a 55 ea f5 0f 84 65 d3 1b 97 40 e4 3e 5b 24 8b b1 2e f4 eb d6 4c 58 20 c4 89 10 bc 50 8a f7 46 0f 66 6d fa f3 41 e5 e1 e0 11 03 25 cf ae d2 c8 93 c8 8c 3e 41 e8 33 e6 

info for K_3m (CBOR-encoded) (53 bytes)
84 0a 83 f6 f6 f6 83 f6 f6 f6 83 18 80 45 44 a1 04 41 21 58 20 c4 89 10 bc 50 8a f7 46 0f 66 6d fa f3 41 e5 e1 e0 11 03 25 cf ae d2 c8 93 c8 8c 3e 41 e8 33 e6 

K_3m (16 bytes)
33 fa f7 1d a1 ae a9 37 f8 dd 8a da 7f 09 61 65 

info for IV_3m (CBOR-encoded) (66 bytes)
84 6d 49 56 2d 47 45 4e 45 52 41 54 49 4f 4e 83 f6 f6 f6 83 f6 f6 f6 83 18 68 45 44 a1 04 41 21 58 20 c4 89 10 bc 50 8a f7 46 0f 66 6d fa f3 41 e5 e1 e0 11 03 25 cf ae d2 c8 93 c8 8c 3e 41 e8 33 e6 

IV_3m (13 bytes)
d8 5b b1 9c 55 c0 92 fc 95 22 56 2b e6 

MAC_3 (8 bytes)
73 a9 2d fa 55 a5 89 d2 

Signature_or_MAC_2 (8 bytes)
d5 2b 3f c1 87 5d c2 78 

P_3ae (10 bytes)
09 48 73 a9 2d fa 55 a5 89 d2 

A_3ae (CBOR-encoded) (45 bytes)
83 68 45 6e 63 72 79 70 74 30 40 58 20 c4 89 10 bc 50 8a f7 46 0f 66 6d fa f3 41 e5 e1 e0 11 03 25 cf ae d2 c8 93 c8 8c 3e 41 e8 33 e6 

info for K_3ae (CBOR-encoded) (48 bytes)
84 0a 83 f6 f6 f6 83 f6 f6 f6 83 18 80 40 58 20 c4 89 10 bc 50 8a f7 46 0f 66 6d fa f3 41 e5 e1 e0 11 03 25 cf ae d2 c8 93 c8 8c 3e 41 e8 33 e6 

K_3ae (16 bytes)
ef 89 06 10 ae 3d 38 20 a7 40 47 1f 1a b5 2e 1c 

info for IV_3ae (CBOR-encoded) (61 bytes)
84 6d 49 56 2d 47 45 4e 45 52 41 54 49 4f 4e 83 f6 f6 f6 83 f6 f6 f6 83 18 68 40 58 20 c4 89 10 bc 50 8a f7 46 0f 66 6d fa f3 41 e5 e1 e0 11 03 25 cf ae d2 c8 93 c8 8c 3e 41 e8 33 e6 

IV_3ae (13 bytes)
bc 46 56 bb 63 ae e7 5e 7a c5 03 ee 34 

CIPHERTEXT_3 (18 bytes)
d0 c8 b5 ce 87 65 b6 ee 11 2f a4 1d 6f af 8e 24 e2 b3 

message_3 (CBOR Sequence) (20 bytes)
35 52 d0 c8 b5 ce 87 65 b6 ee 11 2f a4 1d 6f af 8e 24 e2 b3 

---------------------------------------------------------------

Input to SHA-256 to calculate TH_4 ( TH_3, CIPHERTEXT_3 ) (CBOR Sequence) (53 bytes)
58 20 c4 89 10 bc 50 8a f7 46 0f 66 6d fa f3 41 e5 e1 e0 11 03 25 cf ae d2 c8 93 c8 8c 3e 41 e8 33 e6 52 d0 c8 b5 ce 87 65 b6 ee 11 2f a4 1d 6f af 8e 24 e2 b3 

TH_4 (32 bytes)
36 e3 51 3f 97 7c 3e ca 65 cf ca 40 78 64 a1 66 38 ef c7 0e c1 9b 07 36 89 58 76 ec 96 ec c4 75 

info for OSCORE Master Secret (CBOR-encoded) (68 bytes)
84 74 4f 53 43 4f 52 45 20 4d 61 73 74 65 72 20 53 65 63 72 65 74 83 f6 f6 f6 83 f6 f6 f6 83 18 80 40 58 20 36 e3 51 3f 97 7c 3e ca 65 cf ca 40 78 64 a1 66 38 ef c7 0e c1 9b 07 36 89 58 76 ec 96 ec c4 75 

OSCORE Master Secret (16 bytes)
d8 a1 70 9e 7c db 49 fe 6e 87 53 19 51 c5 7a 19 

info for OSCORE Master Salt (CBOR-encoded) (66 bytes)
84 72 4f 53 43 4f 52 45 20 4d 61 73 74 65 72 20 53 61 6c 74 83 f6 f6 f6 83 f6 f6 f6 83 18 40 40 58 20 36 e3 51 3f 97 7c 3e ca 65 cf ca 40 78 64 a1 66 38 ef c7 0e c1 9b 07 36 89 58 76 ec 96 ec c4 75 

OSCORE Master Salt (8 bytes)
d7 61 a0 ce 86 88 c8 40 

Client's OSCORE Sender ID (1 bytes)
02 

Server's OSCORE Sender ID (1 bytes)
01 

AEAD Algorithm
10

HMAC Algorithm
5

---------------------------------------------------------------
Test Vectors for EDHOC Authenticated with PSK + PSK
---------------------------------------------------------------

Shared COSE_Key =
{
   2:  h'2c',
  -1:  h'926e3d099ea245425988a303ee4afd81',
}

method (PSK + PSK)
4

---------------------------------------------------------------

corr (Initiator can correlate message_1 and message_2)
1

METHOD_CORR (4 * method + corr)
17

suite
0

X (Initiator's ephemeral private key) (32 bytes)
f6 69 57 ed 64 43 ff 63 30 0d 2a aa 7f 3b ef e6 82 f0 4a 10 47 bb 29 3e 88 98 50 50 0c bb a4 2b 

G_X (Initiator's ephemeral public key) (32 bytes)
fc d1 6b 5e 9b 9e c9 d4 8b 9f c8 82 f2 36 09 ff 33 38 8a e7 5c 41 48 10 56 d7 43 d8 92 b4 ac 6b 

Connection identifier chosen by Initiator (1 bytes)
0c 

message_1 (CBOR Sequence) (38 bytes)
11 00 58 20 fc d1 6b 5e 9b 9e c9 d4 8b 9f c8 82 f2 36 09 ff 33 38 8a e7 5c 41 48 10 56 d7 43 d8 92 b4 ac 6b 2b 14 

---------------------------------------------------------------

Y (Responder's ephemeral private key) (32 bytes)
fa b1 11 27 cc 3f 1c 19 f0 89 f7 2f 95 5f 0a 7a de e7 61 b7 bb 56 2a b0 06 69 68 bb e4 11 2d 7f 

G_Y (Responder's ephemeral public key) (32 bytes)
b1 f4 73 d7 91 85 f6 57 d8 35 bb 72 ab cf c2 51 29 b1 06 6b 13 75 72 04 cf 78 74 f9 b9 b3 be 7f 

G_XY (ECDH shared secret) (32 bytes)
ca ab b2 5e a9 26 02 9d 31 c2 7c 64 59 5a e5 97 98 33 7e 09 e6 93 c9 03 66 e3 31 58 30 12 27 36 

salt (0 bytes)


PRK_2e (32 bytes)
a1 3f 05 7a 77 96 12 d3 dd 70 be 0e f4 3b 92 a5 8a 9a f8 19 e1 3e 2d fb d9 5d eb 05 56 a3 8e db 

PRK_3e2m (32 bytes)
a1 3f 05 7a 77 96 12 d3 dd 70 be 0e f4 3b 92 a5 8a 9a f8 19 e1 3e 2d fb d9 5d eb 05 56 a3 8e db 

Connection identifier chosen by Responder (1 bytes)
0d 

data_2 (CBOR Sequence) (35 bytes)
58 20 b1 f4 73 d7 91 85 f6 57 d8 35 bb 72 ab cf c2 51 29 b1 06 6b 13 75 72 04 cf 78 74 f9 b9 b3 be 7f 2a 

Input to SHA-256 to calculate TH_2 ( message_1, data_2 ) (CBOR Sequence) (73 bytes)
11 00 58 20 fc d1 6b 5e 9b 9e c9 d4 8b 9f c8 82 f2 36 09 ff 33 38 8a e7 5c 41 48 10 56 d7 43 d8 92 b4 ac 6b 2b 14 58 20 b1 f4 73 d7 91 85 f6 57 d8 35 bb 72 ab cf c2 51 29 b1 06 6b 13 75 72 04 cf 78 74 f9 b9 b3 be 7f 2a 

TH_2 (32 bytes)
86 64 33 d7 84 40 f7 35 f5 0e 5d fa 76 b6 79 6b 80 17 48 4a d3 3a b0 6d 9e 9b 58 fa 27 b9 7b 46 

P_2ae (0 bytes)


A_2ae (CBOR-encoded) (45 bytes)
83 68 45 6e 63 72 79 70 74 30 40 58 20 86 64 33 d7 84 40 f7 35 f5 0e 5d fa 76 b6 79 6b 80 17 48 4a d3 3a b0 6d 9e 9b 58 fa 27 b9 7b 46 

info for K_2ae (CBOR-encoded) (48 bytes)
84 0a 83 f6 f6 f6 83 f6 f6 f6 83 18 80 40 58 20 86 64 33 d7 84 40 f7 35 f5 0e 5d fa 76 b6 79 6b 80 17 48 4a d3 3a b0 6d 9e 9b 58 fa 27 b9 7b 46 

K_2ae (16 bytes)
72 b2 48 74 96 c6 75 8c 65 af 25 82 eb 77 44 35 

info for IV_2ae (CBOR-encoded) (61 bytes)
84 6d 49 56 2d 47 45 4e 45 52 41 54 49 4f 4e 83 f6 f6 f6 83 f6 f6 f6 83 18 68 40 58 20 86 64 33 d7 84 40 f7 35 f5 0e 5d fa 76 b6 79 6b 80 17 48 4a d3 3a b0 6d 9e 9b 58 fa 27 b9 7b 46 

IV_2ae (13 bytes)
d7 94 0b ea 48 bf 93 01 4b 03 61 b6 c3 

CIPHERTEXT_2 (8 bytes)
60 b8 6c a1 69 e9 49 0d 

message_2 (CBOR Sequence) (44 bytes)
58 20 b1 f4 73 d7 91 85 f6 57 d8 35 bb 72 ab cf c2 51 29 b1 06 6b 13 75 72 04 cf 78 74 f9 b9 b3 be 7f 2a 48 60 b8 6c a1 69 e9 49 0d 

---------------------------------------------------------------

PRK_4x3m (32 bytes)
a1 3f 05 7a 77 96 12 d3 dd 70 be 0e f4 3b 92 a5 8a 9a f8 19 e1 3e 2d fb d9 5d eb 05 56 a3 8e db 

data_3 (CBOR Sequence) (1 bytes)
2a 

Input to SHA-256 to calculate TH_3 ( TH_2, CIPHERTEXT_2, data_3 ) (CBOR Sequence) (44 bytes)
58 20 86 64 33 d7 84 40 f7 35 f5 0e 5d fa 76 b6 79 6b 80 17 48 4a d3 3a b0 6d 9e 9b 58 fa 27 b9 7b 46 48 60 b8 6c a1 69 e9 49 0d 2a 

TH_3 (32 bytes)
9e 2d 28 8b 99 da d5 a9 bb ac c9 15 cd b3 e3 30 87 4a 2c 10 a2 dd c1 fa 0f 76 48 3b 9a 93 6d fd 

P_3ae (0 bytes)


A_3ae (CBOR-encoded) (45 bytes)
83 68 45 6e 63 72 79 70 74 30 40 58 20 9e 2d 28 8b 99 da d5 a9 bb ac c9 15 cd b3 e3 30 87 4a 2c 10 a2 dd c1 fa 0f 76 48 3b 9a 93 6d fd 

info for K_3ae (CBOR-encoded) (48 bytes)
84 0a 83 f6 f6 f6 83 f6 f6 f6 83 18 80 40 58 20 9e 2d 28 8b 99 da d5 a9 bb ac c9 15 cd b3 e3 30 87 4a 2c 10 a2 dd c1 fa 0f 76 48 3b 9a 93 6d fd 

K_3ae (16 bytes)
b3 ff 87 dd bd 51 56 96 68 3b 5a a0 2f 12 b3 3e 

info for IV_3ae (CBOR-encoded) (61 bytes)
84 6d 49 56 2d 47 45 4e 45 52 41 54 49 4f 4e 83 f6 f6 f6 83 f6 f6 f6 83 18 68 40 58 20 9e 2d 28 8b 99 da d5 a9 bb ac c9 15 cd b3 e3 30 87 4a 2c 10 a2 dd c1 fa 0f 76 48 3b 9a 93 6d fd 

IV_3ae (13 bytes)
6a 1e 89 98 10 ac 00 ef 1d 2c e6 6e 9a 

CIPHERTEXT_3 (8 bytes)
8a 1f ec e0 1c 28 29 38 

message_3 (CBOR Sequence) (10 bytes)
2a 48 8a 1f ec e0 1c 28 29 38 

---------------------------------------------------------------

Input to SHA-256 to calculate TH_4 ( TH_3, CIPHERTEXT_3 ) (CBOR Sequence) (43 bytes)
58 20 9e 2d 28 8b 99 da d5 a9 bb ac c9 15 cd b3 e3 30 87 4a 2c 10 a2 dd c1 fa 0f 76 48 3b 9a 93 6d fd 48 8a 1f ec e0 1c 28 29 38 

TH_4 (32 bytes)
84 c1 7d f4 d9 26 3d b0 d4 79 64 16 12 1f 0f 7a 52 54 e2 a8 72 13 14 6c d2 fd d3 eb f1 c2 ce 10 

info for OSCORE Master Secret (CBOR-encoded) (68 bytes)
84 74 4f 53 43 4f 52 45 20 4d 61 73 74 65 72 20 53 65 63 72 65 74 83 f6 f6 f6 83 f6 f6 f6 83 18 80 40 58 20 84 c1 7d f4 d9 26 3d b0 d4 79 64 16 12 1f 0f 7a 52 54 e2 a8 72 13 14 6c d2 fd d3 eb f1 c2 ce 10 

OSCORE Master Secret (16 bytes)
27 74 d8 33 a0 78 15 6c 92 27 26 19 9e 6c 28 b2 

info for OSCORE Master Salt (CBOR-encoded) (66 bytes)
84 72 4f 53 43 4f 52 45 20 4d 61 73 74 65 72 20 53 61 6c 74 83 f6 f6 f6 83 f6 f6 f6 83 18 40 40 58 20 84 c1 7d f4 d9 26 3d b0 d4 79 64 16 12 1f 0f 7a 52 54 e2 a8 72 13 14 6c d2 fd d3 eb f1 c2 ce 10 

OSCORE Master Salt (8 bytes)
9d 24 f1 6b 51 c7 d4 ee 

Client's OSCORE Sender ID (1 bytes)
0d 

Server's OSCORE Sender ID (1 bytes)
0c 

AEAD Algorithm
10

HMAC Algorithm
5
